<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible">
        <title>game 1</title>
        <style media="screen">
            canvas {
                border: 1px black solid;
            }

        </style>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- <link rel="stylesheet" type="text/css" media="screen" href="main.css" /> -->
        <script src="main.js"></script>
    </head>
    <body>
        <canvas id="id-canvas" width="400" height="300"></canvas>
        <script>
            var log = console.log.bind(console)

            var imageFromPath =function(path) {
                var img = new Image();
                img.src = path
                return img
            }

            var Paddle = function() {
                var image = imageFromPath('images/paddle.png')
                var o = {
                    image: image,
                    x: 100,
                    y: 200,
                    speed: 5,
                }
                o.moveLeft = function(){
                    o.x -= o.speed
                }
                o.moveRight = function(){
                    o.x += o.speed
                }
                return o
            }


            var GamePrepare = function() {
                var g = {}
                var canvas = document.querySelector('#id-canvas')
                var context = canvas.getContext('2d')
                g.canvas = canvas
                g.context = context
    
                setInterval(function(){
                    // update
                    g.update()
                    // clear
                    context.clearRect(0, 0, canvas.width, canvas.height);
                    // draw
                    g.draw()
                }, 1000/30)

//49分钟

                return g
            }

            var __main = function() {
                var game = GamePrepare()

                var paddle = Paddle()


                var leftDown = false
                var rightDown = false
                // events
                window.addEventListener('keydown',function(event){
                    var k = event.key
                    // log(event)
                    if(k == 'a'){
                        leftDown = true
                    }else if (k == 'd'){
                        rightDown = true
                    }
                })
                window.addEventListener('keyup',function(event){
                    var k = event.key
                    // log(event)
                    if(k == 'a'){
                        leftDown = false
                    }else if (k == 'd'){
                        rightDown = false
                    }
                })

                game.update = function() {
                    // update x
                    if(leftDown){
                        paddle.moveLeft()
                    }else if(rightDown){
                        paddle.moveRight()
                    }
                }

                game.draw = function () {
                    game.context.drawImage(paddle.image,paddle.x,paddle.y);
                }
            }


            __main()
        </script>
    </body>
</html>